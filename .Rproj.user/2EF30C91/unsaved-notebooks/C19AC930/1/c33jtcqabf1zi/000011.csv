"0","# Simulation Parameters"
"0","sample_sizes <- seq(30, 80, by = 5)"
"0","nsim <- 1000 "
"0","sd_acc <- 0.2"
"0","alpha <- 0.05"
"0",""
"0","# Run the simulation loop"
"0","power_results_acc <- sapply(sample_sizes, function(n) {"
"0","  significant_results <- 0"
"0","  for (i in 1:nsim) {"
"0","    sim_data <- tibble("
"0","      id = factor(rep(1:n, each = 18)),"
"0","      sound = factor(rep(c(""Looming"", ""Stationary"", ""No_Sound""), each = 6, times = n)),"
"0","      location = factor(rep(c(""Center"", ""Periphery""), each = 3, times = 3 * n)),"
"0","      difficulty = factor(rep(c(""Easy"", ""Medium"", ""Hard""), times = 6 * n)),"
"0","      accuracy = rnorm(n * 18, mean = rep(mu_vector_acc, times = n), sd = sd_acc)"
"0","    )"
"0","    "
"0","    # Use a stable model and tryCatch to handle any errors"
"0","    p_value <- tryCatch({"
"0","      model_anova <- suppressMessages(aov_4(accuracy ~ sound * location * difficulty + (1 | id), data = sim_data))"
"0","      summary(model_anova)$anova_table$`Pr(>F)`[7]"
"0","    }, error = function(e) { NA })"
"0","    "
"0","    if (!is.na(p_value) && p_value < alpha) {"
"0","      significant_results <- significant_results + 1"
"0","    }"
"0","  }"
"0","  significant_results / nsim"
"0","})"
"0",""
"0","# Store results"
"0","power_curve_data_acc <- tibble(n_subjects = sample_sizes, power = power_results_acc)"
