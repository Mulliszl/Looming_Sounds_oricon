"0","# --- Step 1: Load Libraries and Data ---"
"0",""
"0","library(tidyverse)"
"0","library(readxl)"
"0",""
"0","# Provide the FULL path to the XLSX file."
"0","file_path <- ""C:/Users/zach/OneDrive - North Carolina State University/TVLR/Looming_Sounds_Contrast/Zach work/ori_con_full.xlsx"""
"0","ori_con_data <- read_xlsx(file_path, col_names = TRUE)"
"0",""
"0",""
"0","# --- Step 2: Clean Data by Renaming Columns by Position ---"
"0",""
"0","# This is the most robust method for cleaning the column names."
"0","colnames(ori_con_data)[5] <- ""sound"""
"0","colnames(ori_con_data)[8] <- ""location"""
"0","colnames(ori_con_data)[9] <- ""difficulty"""
"0","colnames(ori_con_data)[11] <- ""correct"""
"0","colnames(ori_con_data)[12] <- ""rt"""
"0",""
"0",""
"0","# --- Step 3: Calculate Means for the ""Easy"" Condition with Robust Handling ---"
"0",""
"0","# First, filter for the orientation task and create base factors."
"0","easy_condition_data <- ori_con_data %>%"
"0","  filter(task_type == ""orientation"") %>%"
"0","  mutate("
"0","    correct = as.numeric(correct), "
"0","    rt = as.numeric(rt),"
"0","    sound_condition = factor(sound,"
"0","                             levels = c(32, 1, -1),"
"0","                             labels = c(""Looming"", ""Stationary"", ""No_Sound"")),"
"0","    visual_location = factor(location,"
"0","                             levels = c(0, 1),"
"0","                             labels = c(""Center"", ""Periphery""))"
"0","  )"
"0",""
"0","# --- FIX: Create a complete grid to ensure all 6 conditions are present ---"
"0","# This prevents errors if the pilot data is missing a combination."
"0","all_conditions <- expand.grid("
"0","  sound_condition = c(""Looming"", ""Stationary"", ""No_Sound""),"
"0","  visual_location = c(""Center"", ""Periphery"")"
"0",")"
"0",""
"0","# Calculate ""Easy"" accuracy means and join to the complete grid"
"0","easy_acc_means <- easy_condition_data %>%"
"0","  group_by(sound_condition, visual_location) %>%"
"0","  dplyr::summarise(mean_acc = mean(correct, na.rm = TRUE), .groups = 'drop') %>%"
"0","  right_join(all_conditions, by = c(""sound_condition"", ""visual_location"")) %>%"
"0","  # Fill any missing values with the average of the present values"
"0","  mutate(mean_acc = ifelse(is.na(mean_acc), mean(mean_acc, na.rm = TRUE), mean_acc)) %>%"
"0","  dplyr::arrange(sound_condition, visual_location)"
"0",""
"0","# Calculate ""Easy"" RT means and join to the complete grid"
"0","easy_rt_means <- easy_condition_data %>%"
"0","  filter(correct == 1) %>%"
"0","  group_by(sound_condition, visual_location) %>%"
"0","  dplyr::summarise(mean_rt = mean(rt, na.rm = TRUE), .groups = 'drop') %>%"
"0","  right_join(all_conditions, by = c(""sound_condition"", ""visual_location"")) %>%"
"0","  # Fill any missing values with the average of the present values"
"0","  mutate(mean_rt = ifelse(is.na(mean_rt), mean(mean_rt, na.rm = TRUE), mean_rt)) %>%"
"0","  dplyr::arrange(sound_condition, visual_location)"
"0",""
"0",""
"0","# --- Step 4: Estimate ""Medium"" & ""Hard"" Conditions Based on Manuscript Theory ---"
"0",""
"0","# Theory: Any sound helps vs. No Sound, effect is largest at Medium difficulty."
"0","acc_matrix <- matrix(c("
"0","  1.00, 0.90, 0.80,  # Looming-Center"
"0","  1.00, 0.90, 0.80,  # Looming-Periphery"
"0","  1.00, 0.90, 0.80,  # Stationary-Center"
"0","  1.00, 0.90, 0.80,  # Stationary-Periphery"
"0","  0.98, 0.85, 0.78,  # NoSound-Center (slightly worse)"
"0","  0.98, 0.85, 0.78   # NoSound-Periphery (slightly worse)"
"0","), nrow = 6, byrow = TRUE)"
"0",""
"0","rt_matrix <- matrix(c("
"0","   0,  75, 150,  # Looming-Center"
"0","   0,  75, 150,  # Looming-Periphery"
"0","   0,  75, 150,  # Stationary-Center"
"0","   0,  75, 150,  # Stationary-Periphery"
"0","  10, 100, 160,  # NoSound-Center (slightly slower)"
"0","  10, 100, 160   # NoSound-Periphery (slightly slower)"
"0","), nrow = 6, byrow = TRUE)"
"0",""
"0","# Build the final vectors"
"0","mu_vector_acc <- as.vector(t(outer(easy_acc_means$mean_acc, c(1,1,1)) * acc_matrix))"
"0","mu_vector_rt <- as.vector(t(outer(easy_rt_means$mean_rt, c(1,1,1)) + rt_matrix))"
"0",""
"0",""
"0","# --- Step 5: Display the Final Estimated mu_vectors ---"
"0",""
"0","cat(""--- For Accuracy (Theory-Adjusted Vector, length 18) ---\n"")"
"1","--- For Accuracy (Theory-Adjusted Vector, length 18) ---
"
"0","dput(mu_vector_acc)"
"1","c(0.666831275720165, 0.600148148148148, 0.533465020576132, 0.676049382716049, 
"
"1","0.608444444444444, 0.54083950617284, 0.666831275720165, 0.600148148148148, 
"
"1","0.533465020576132, 0.671604938271605, 0.604444444444444, 0.537283950617284, 
"
"1","0.653494650205761, 0.56680658436214, 0.520128395061728, 0.639782716049383, 
"
"1","0.554913580246914, 0.509214814814815)
"
"0","cat(""\n--- For Response Time (Theory-Adjusted Vector, length 18) ---\n"")"
"1","
--- For Response Time (Theory-Adjusted Vector, length 18) ---
"
"0","dput(mu_vector_rt)"
"1","c(481.836571922442, 556.836571922442, 631.836571922442, 463.314828341855, 
"
"1","538.314828341855, 613.314828341855, 481.836571922442, 556.836571922442, 
"
"1","631.836571922442, 449.114705882353, 524.114705882353, 599.114705882353, 
"
"1","491.836571922442, 581.836571922442, 641.836571922442, 543.080181543117, 
"
"1","633.080181543117, 693.080181543117)
"
